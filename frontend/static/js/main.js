"use strict";function login(t){t.preventDefault();var e={username:$("#username").val(),password:$("#password").val()};$.ajax({type:"POST",url:"/login",data:e}).done(function(t,e,a){window.location.href="/upload.html"}).fail(function(t){var e=JSON.parse(t.responseText).error;$(".message").html("<p>"+e+"</p>")})}function register(t){t.preventDefault();var e={username:$("#username").val(),password:$("#password").val(),confirm_password:$("#confirm_password").val(),email:$("#email").val()};$.ajax({type:"POST",url:"/register",data:e}).done(function(t,e,a){window.location.href="/index.html"}).fail(function(t){var e=JSON.parse(t.responseText).error;$(".message").html("<p>"+e+"</p>")})}function search(t){if(t.preventDefault(),""!==$("#search-input").val()){$("#searchbar").addClass("search-active");var e={query:$("#search-input").val()};$.ajax({type:"POST",url:"/search",data:e}).done(function(t){t?($("#columns").show(),showResults(t)):window.location.href="/login.html"})}else $("#columns").hide(),$("#searchbar").removeClass("search-active")}function showResults(t){$("#columns").empty();for(var e=0;e<t.length;e++)$("#columns").append('\n\t\t\t<div class="card-padding">\n\t\t\t\t<div class="card" data-id="'+e+'" data-name="'+t[e].name+'"> \n\t\t\t\t\t<div class="card-image">\n\t\t\t\t\t\t<img src="/uploads/'+t[e].name+'">\n\t\t\t\t\t\t<span class="card-title" onclick="changeName(this, \''+t[e].name+"', '"+t[e].originalName+"')\">"+t[e].originalName+'</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="card-content">\n\t\t\t\t\t\t<div id="result'+e+'" class="chips"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'),getLabels(t[e],e)}function getLabels(t,e){for(var a=[],n=0;n<t.labels.length;n++)a.push({tag:t.labels[n].name});$("#result"+e).material_chip({data:a,placeholder:"Add a tag"}),$("#result"+e).on("chip.delete",function(t,a){var n=$('[data-id="'+e+'"]')[0].dataset.name;$.ajax({type:"POST",url:"/removelabel",data:{label:a.tag,photo:n}})}),$("#result"+e).on("chip.add",function(t,a){var n=$('[data-id="'+e+'"]')[0].dataset.name;$.ajax({type:"POST",url:"/addlabel",data:{label:a.tag,photo:n}})})}function changeName(t,e,a){var n=document.createElement("span");n.className="card-title",n.innerHTML='\n\t\t<form><input class="change-title" type="text" name="title" placeholder="Enter new title"><form>\n\t',n.addEventListener("submit",function(l){l.preventDefault();var i=$(".change-title").val();$.ajax({type:"POST",url:"/changetitle",data:{newTitle:i,name:e,originalName:a}}),t.innerHTML=i,n.parentNode.replaceChild(t,n)}),t.parentNode.replaceChild(n,t),$(".change-title").focus()}function upload(t){t.preventDefault();var e=$("#formData")[0],a=new FormData(e);$.ajax({type:"POST",url:"/upload",data:a,cache:!1,contentType:!1,processData:!1}).done(function(t){t?window.location.href="/search.html":window.location.href="/login.html"}).fail(function(t){console.log(t)}),$("#loader").replaceWith('\n\t\t<div class="preloader-wrapper big active center-block">\n\t\t\t<div class="spinner-layer spinner-layer">\n\t\t\t\t<div class="circle-clipper left">\n\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="gap-patch">\n\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="circle-clipper right">\n\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t')}$(document).ready(function(){document.getElementById("login")&&$("#login").on("click",login),document.getElementById("register")&&$("#register").on("click",register),document.getElementById("upload")&&$("#upload").on("click",upload),document.getElementById("search-input")&&$("#search-input").on("input propertychange",search),document.getElementById("logout-message")&&(setTimeout(function(){window.location.href="/"},3e3),$.ajax({type:"POST",url:"/logout"}))});
//# sourceMappingURL=main.js.map
